å¯¹äºè½¯ä»¶å¼€å‘è€Œè¨€ï¼Œå•æ­¥è°ƒè¯•ä¸€ç›´æ˜¯å®šä½é—®é¢˜çš„ç¥å™¨ï¼Œä¸€æ­¥ä¸€æ­¥ç¡®è®¤æ’æŸ¥å¯ä»¥è®© bug æ— æ‰€éå½¢ã€‚

æœ¬æ–‡ç®€è¿° Egg è¿œç¨‹è°ƒè¯•æ–¹å¼åŠå®ç°åŸç†ã€‚

## æœ€ç®€å•çš„ egg è°ƒè¯•æµç¨‹
å…³äº egg debug çš„å‘½ä»¤å’Œå…·ä½“çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå¯ä»¥æŸ¥çœ‹ [ä½¿ç”¨ egg-bin è°ƒè¯•](https://egg-docs.implements.io/zh-cn/core/development.html#%E6%B7%BB%E5%8A%A0%E5%91%BD%E4%BB%A4-3)ã€‚

ä¸€æ¡æœ€ç®€å•çš„ egg debug å‘½ä»¤ æ˜¯:
```bash
$ egg-bin debug
```

ä½ ä¼šå‘ç°å‘½ä»¤è¡Œä¸­ä¼šè¾“å‡º console:
```bash
$ Debug Proxy online, now you could attach to 9999 without worry about reload.
$ DevTools â†’ chrome-devtools://devtools/bundled/inspector.html?experiments=true&v8only=true&ws=127.0.0.1:9999/__ws_proxy__
```

å°†è¿™æ¡é“¾æ¥åœ¨æµè§ˆå™¨æ‰“å¼€ï¼Œå³åˆ»è°ƒè¯• Egg çš„ worker è¿›ç¨‹

âš ï¸æ³¨æ„ç‚¹
* debug æ¨¡å¼æ‰“å¼€ï¼Œå®ˆæŠ¤è¿›ç¨‹åªä¼šå¼€å¯ä¸€ä¸ª worker è¿›ç¨‹ï¼›
* å¦‚æœè¦æœ¬åœ°è°ƒè¯•æµ‹è¯•ç¯å¢ƒï¼Œè¯·æŠŠ 127.0.0.1:9999 æ›¿æ¢æˆæµ‹è¯•ç¯å¢ƒ ipï¼›

## å¦‚ä½•å®šåˆ¶ egg å¤šä¸ªè¿›ç¨‹çš„ debug ç«¯å£

ç”±äºæµ‹è¯•æœºèµ„æºé—®é¢˜ï¼Œå¯èƒ½ä¼šåœ¨ä¸€å°äº‘ä¸»æœºä¸Šéƒ¨ç½²å¤šä¸ª Node åº”ç”¨ï¼Œæ­¤æ—¶ä¼šå‡ºç° debug ç«¯å£å†²çªçš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è¿›è¡Œçµæ´»åœ°é…ç½®å„ä¸ªè¿›ç¨‹çš„ debug ç«¯å£å·

```bash
$ EGG_AGENT_DEBUG_PORT=7878 egg-bin debug --proxy=9999 --inspect=7879
```

ç¯å¢ƒå˜é‡ä¸å‚æ•°è¯´æ˜ï¼š
* inspect
 * master è¿›ç¨‹è°ƒè¯•ç«¯å£ç›´æ¥å–è‡ª inspect è®¾ç½®çš„å€¼ï¼Œé»˜è®¤ 9229
 * worker è¿›ç¨‹è°ƒè¯•ç«¯å£ä¼šå¯¹ inspect å­—æ®µç´¯åŠ åå–å¯ç”¨ç«¯å£
* EGG_AGENT_DEBUG_PORT - agent è°ƒè¯•ç«¯å£è®¾å®šï¼Œé»˜è®¤ 5800
* proxy - worker è¿›ç¨‹è°ƒè¯•ç«¯å£è®¾å®šï¼ˆè½¬å‘ websocket åè®®åˆ°çœŸå®çš„ worker è¿›ç¨‹è°ƒè¯•ç«¯å£ï¼‰ï¼Œé»˜è®¤ 9999

## å¦‚ä½•è°ƒè¯• agent è¿›ç¨‹
å¯¹äºä¸€èˆ¬çš„ç”¨æˆ·è€Œè¨€ï¼Œä¸å¤ªéœ€è¦å…³å¿ƒ `agent` è¿›ç¨‹çš„å­˜åœ¨ï¼Œä½†æ˜¯å¯¹äºæ’ä»¶å¼€å‘è€…ï¼Œå¯èƒ½éœ€è¦å¯¹ `agent` è¿›ç¨‹è¿›è¡Œè°ƒè¯•æˆ–è€…åšæ€§èƒ½é—®é¢˜æ’æŸ¥ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ç‚¹äº® `agent` è¿›ç¨‹è°ƒè¯•çš„æŠ€èƒ½ã€‚

æ‰§è¡Œä»¥ä¸‹è„šæœ¬å¯åŠ¨åº”ç”¨ï¼š

```
$ npm run debug
```

æ‰¾åˆ°ç¬¬äºŒæ¡ debug å¯åŠ¨æ—¥å¿—ï¼ˆmasterã€ agentã€workerçš„å¯åŠ¨é¡ºåºï¼‰
![image](https://user-images.githubusercontent.com/10825163/43468710-3fe86518-9517-11e8-9bab-2826f215179e.png)


é»˜è®¤å€¼ä¸º 5800

ä½¿ç”¨ chrome æµè§ˆå™¨æ‰“å¼€ `chrome://inspect`ï¼Œç‚¹å‡» ` Discover network targets` ğŸ‘‰çš„ **configure** æŒ‰é’®
![image](https://user-images.githubusercontent.com/10825163/43468727-4876a8de-9517-11e8-8bb5-6c2f32fa58e1.png)


é…ç½® agent è¿›ç¨‹çš„ debug ç«¯å£å·
![image](https://user-images.githubusercontent.com/10825163/43468735-4e2fe970-9517-11e8-9a9f-6e3832558d66.png)


ç‚¹å‡» done ä¹‹åï¼Œä½ ä¼šå‘ç° `chrome://inspect` å¤šäº†ä¸€ä¸ª agent è°ƒè¯•çš„ target
![image](https://user-images.githubusercontent.com/10825163/43468741-524bc81c-9517-11e8-985d-ae4e0cd4c303.png)

## å°ç»“
ä»¥ä¸Šä¸º egg åº”ç”¨çš„ä¸€äº›ç®€å•çš„è°ƒè¯•æ–¹æ³•ï¼Œå¯¹äº egg ä¸ºä½•éœ€è¦ proxy debug åè®®ï¼Œä»¥åŠå¦‚ä½•è°ƒè¯•ä»»æ„çš„ Node è¿›ç¨‹ï¼Œåé¢å†åšä»‹ç»